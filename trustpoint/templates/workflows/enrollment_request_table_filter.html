{% load i18n %}

<div class="mb-3">
  <div class="card-body pb-0">
    <button
      class="btn btn-sm btn-outline-secondary mb-1"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#filterCollapse"
      aria-expanded="{% if request.GET %}true{% else %}false{% endif %}"
      aria-controls="filterCollapse">
      {% trans 'Filters' %}
    </button>
  </div>

  <div class="collapse{% if request.GET %} show{% endif %}" id="filterCollapse">
    <div class="card-body">
      <form method="get">

        <!-- Row 1 -->
        <div class="row gx-3 gy-2 align-items-end">
          <div class="col-md-3">
            <label for="{{ filter.form.device_name.id_for_label }}" class="form-label">
              {{ filter.form.device_name.label }}
            </label>
            {{ filter.form.device_name }}
          </div>

          <div class="col-md-3">
            <label for="{{ filter.form.domain.id_for_label }}" class="form-label">
              {{ filter.form.domain.label }}
            </label>
            {{ filter.form.domain }}
          </div>

          <div class="col-md-2">
            <label for="{{ filter.form.protocol.id_for_label }}" class="form-label">
              {{ filter.form.protocol.label }}
            </label>
            {{ filter.form.protocol }}
          </div>

          <div class="col-md-2">
            <label for="{{ filter.form.operation.id_for_label }}" class="form-label">
              {{ filter.form.operation.label }}
            </label>
            {{ filter.form.operation }}
          </div>

          <div class="col-md-2">
            <label for="{{ filter.form.template.id_for_label }}" class="form-label">
              {{ filter.form.template.label }}
            </label>
            {{ filter.form.template }}
          </div>
        </div>

        <!-- Row 2 -->
        <div class="row gx-3 gy-2 align-items-end mt-1">
          <div class="col-md-2">
            <label for="{{ filter.form.state.id_for_label }}" class="form-label">
              {{ filter.form.state.label }}
            </label>
            {{ filter.form.state }}
          </div>

          {% if filter.form.include_finalized %}
            <div class="col-md-2 d-flex align-items-center">
              <div class="form-check mt-4">
                {{ filter.form.include_finalized }}
                <label class="form-check-label" for="{{ filter.form.include_finalized.id_for_label }}">
                  {{ filter.form.include_finalized.label }}
                </label>
              </div>
            </div>
          {% endif %}

          <div class="col-md-4">
            <label class="form-label d-block">
              {% trans 'Requested between' %}
            </label>
            <div class="d-flex gap-2">
              {{ filter.form.requested_from }}
              {{ filter.form.requested_to }}
            </div>
          </div>
        </div>

        <!-- Buttons (full width, below all filters) -->
        <div class="row mt-3">
          <div class="col-12 text-start">
            <button type="submit" class="btn btn-sm btn-primary me-2">
              {% trans 'Apply' %}
            </button>
            <a href="{% url 'workflows:request_table' %}" class="btn btn-sm btn-outline-secondary">
              {% trans 'Reset' %}
            </a>
          </div>
        </div>

      </form>
    </div>
  </div>
</div>
