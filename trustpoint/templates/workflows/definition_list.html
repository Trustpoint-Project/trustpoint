{% extends 'trustpoint/base.html' %}
{% load static %}
{% block content %}
  <h1>Workflows</h1>
  <p>
    <a class="btn btn-primary" href="{% url 'workflows:definition_wizard' %}">
      + Create New Workflow
    </a>
    <a class="btn btn-secondary" href="{% url 'workflows:pending_list' %}">
      Pending Approvals
    </a>
  </p>

  <table class="table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Updated</th>
        <th>Published</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for wf in definitions %}
        <tr>
          <td>{{ wf.name }}</td>
          <td>{{ wf.updated_at }}</td>
          <td>{{ wf.published }}</td>
          <td>
            <a class="btn btn-sm btn-primary"
               href="{% url 'workflows:definition_wizard' %}?edit={{ wf.id }}">
              Edit
            </a>

            <form
              action="{% url 'workflows:definition_delete' wf.id %}"
              method="post"
              style="display:inline;"
              onsubmit="return confirm('Delete workflow {{ wf.name }}?');"
            >
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-danger">
                Delete
              </button>
            </form>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="4">No workflows defined.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
